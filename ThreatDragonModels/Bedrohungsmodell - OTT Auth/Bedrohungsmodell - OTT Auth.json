{
  "summary": {
    "title": "Bedrohungsmodell - OTT Auth",
    "owner": "Firma Allsecure",
    "description": "Die Firma Allsecure betreibt unterschiedliche Anwendungen mit Hilfe einer 2-Faktorauthentifizierung via One-time token, der an das entsprechende Smartphone des Nutzers geschickt wird."
  },
  "detail": {
    "contributors": [
      {
        "name": "Georg Neugebauer"
      },
      {
        "name": "Benedict Sivi-Nzo"
      }
    ],
    "diagrams": [
      {
        "cells": [
          {
            "position": {
              "x": 22,
              "y": 28
            },
            "size": {
              "width": 160,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "User"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 1,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "c8c968fe-d53b-4728-b789-52a3199dc715"
                },
                {
                  "group": "right",
                  "id": "757b548f-a149-4c16-b452-9322715b8608"
                },
                {
                  "group": "bottom",
                  "id": "69cbc821-f17b-440b-9067-24a1afe7b4a0"
                },
                {
                  "group": "left",
                  "id": "b46dd25d-6cbc-45bc-ad5e-bc4a8c183c54"
                }
              ]
            },
            "id": "dec51efb-bf55-4b9c-a294-0e45f4e823f6",
            "data": {
              "name": "User",
              "description": "",
              "type": "tm.Actor",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "threats": [],
              "hasOpenThreats": false,
              "providesAuthentication": false
            }
          },
          {
            "position": {
              "x": 290,
              "y": 140
            },
            "size": {
              "width": 130,
              "height": 130
            },
            "attrs": {
              "text": {
                "text": "Login System -\nWebapp +\nMobile App"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 2,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "7b91532c-69b2-4668-8223-f31b7a1fd47e"
                },
                {
                  "group": "right",
                  "id": "6faa2e42-82fc-4c9b-8911-371cbb4fc229"
                },
                {
                  "group": "bottom",
                  "id": "02952830-8e12-4f65-84aa-8152ee567b15"
                },
                {
                  "group": "left",
                  "id": "62dda8bf-0cc2-4b59-9c8c-489786fea245"
                }
              ]
            },
            "id": "a1d5bbe6-465f-43bb-bd96-7ce687db37aa",
            "data": {
              "name": "Login System -\nWebapp +\nMobile App",
              "description": "Vergleicht eingegebenen OTT-Wert auf Telefon mit erwartetem OTT seitens 2-Faktor-Dienst. ",
              "type": "tm.Process",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "threats": [
                {
                  "id": "49eaf072-ffef-429a-b519-fcaa6200de4b",
                  "title": "DDoS",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "Ein DDoS Angriff kann den Login-Dienst überlasten und somit für Anwender unerreichbar machen. \n\nCAPEC-125: Flooding: An adversary consumes the resources of a target by rapidly engaging in a large number of interactions with the target.\n\nATT&CK: TA0038 - Network Effects: The adversary is trying to intercept or manipulate network traffic to or from a device.\n\nD: 8 / R: 10 / E: 8 / A: 10 / DREA: 36",
                  "mitigation": "Firewall, Load-Balancer oder CDN einsetzen, um direkten Datenverkehr auf Login-Server zu begrenzen.\n\nDEFEND: D3-ITF - Inbound Traffic Filtering\nASVS: CWE 770 (8.1.4): Verify the application can detect and alert on abnormal numbers of requests, such as by IP, user, total per hour or day, or whatever makes sense for the application.\n\nD: 4 / R: 10 / E: 4 / A: 10 / Neuer DREA: 28",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 101,
                  "score": "28"
                },
                {
                  "id": "efdaaf3c-d88f-4ac9-a4f4-a3bde71cb898",
                  "title": "Manipulation von App-Daten auf SD-Karte",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Eine bösartige App nutzt Schreibrechte auf der SD-Karte, um Konfigurationsdaten der AllSecure-App zu manipulieren.\n\nCAPEC-ID: CAPEC-165 -> Identity Spoofing\n\nATT&CK-ID: T1565 -> Adversary-in-the-Middle",
                  "mitigation": "Maßnahme: Speicherung im geschützten internen Speicher (Sandboxing).\n\nUmsetzung: Pfade im Code anpassen.\n\nStandard: OWASP MASVS V2\n\nNeuer Score: 17 (Medium)",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 117,
                  "score": "27"
                },
                {
                  "id": "6abb65b1-a562-4f93-ba35-1c8163e92474",
                  "title": "Spoofing durch Abfangen des OTT",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "Angreifer fängt unverschlüsselten OTT im internen Netz ab und nutzt ihn zur Anmeldung\n\nCAPEC-ID: CAPEC-151 -> Identity Spoofing\n\nATT&CK-ID: T1557 -> Adversary-in-the-Middle",
                  "mitigation": "Maßnahme: TLS-Verschlüsselung einführen\n\nUmsetzung: Zertifikate auf allen Servern ausrollen\n\nStandard: MITRE D3FEND D3-MENCR\n\nneuer Score: 22/Medium",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 120,
                  "score": "40"
                }
              ],
              "hasOpenThreats": false,
              "isWebApplication": null,
              "threatFrequency": {
                "spoofing": 3,
                "tampering": 3,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 0,
                "elevationOfPrivilege": 0
              },
              "handlesCardPayment": null,
              "handlesGoodsOrServices": null
            },
            "tools": {
              "items": [
                "boundary",
                "button-remove"
              ],
              "name": null
            }
          },
          {
            "position": {
              "x": 810,
              "y": 208
            },
            "size": {
              "width": 130,
              "height": 140
            },
            "attrs": {
              "text": {
                "text": "2-Faktor-Authe\nntifizierungsdi\nenst"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 3,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "23ca128d-e847-40fe-9dfa-7497c0ea5e90"
                },
                {
                  "group": "right",
                  "id": "e2c6a0d8-3c62-4335-ad49-2f9d708543e3"
                },
                {
                  "group": "bottom",
                  "id": "81742693-1f56-400c-9fd7-4af5a7de34f7"
                },
                {
                  "group": "left",
                  "id": "2cb2dc67-cfc1-4517-9148-8028f935fde0"
                }
              ]
            },
            "id": "94f68ce7-aa88-45a4-ba41-c0b62d6a959c",
            "data": {
              "name": "2-Faktor-Authe\nntifizierungsdi\nenst",
              "description": "",
              "type": "tm.Process",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "threats": [
                {
                  "id": "c2033cac-9968-4bc0-9173-5edb4434adbc",
                  "title": "Diebstahl des statischen Schlüssels",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Angreifer liest den symmetrischen Schlüssel aus einer unverschlüsselten Konfigurationsdatei auf dem Server aus.\n\nCAPEC-ID: IDs: CAPEC-37 -> Retrieve Embedded Sensitive Data\n\nATT&CK-ID: T1552 -> Unsecured Credentials",
                  "mitigation": "Maßnahme: Einsatz eines Key Vaults (Secret Management)\n\nUmsetzung: Schlüssel aus Config löschen, Abruf zur Laufzeit\n\nStandard: OWASP ASVS 6.4.2\n\nNeuer Score: 23 (Medium)",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 113,
                  "score": "34"
                },
                {
                  "id": "8b7dade2-1f98-454c-bc85-7b132eeaf4e1",
                  "title": "Flooding des 2FA-Dienstes",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "Überflutung des nicht-redundanten Dienstes mit massenhaften Anfragen, sodass er abstürzt.\n\nCAPEC-ID: CAPEC-125 -> Flooding\n\nATT&CK-ID: T1498 -> Network Denial of Service",
                  "mitigation": "Maßnahme: Rate Limiting (Verbindungsbegrenzung) einführen.\n\nUmsetzung: Konfiguration im API-Gateway/Webserver.\n\nStandard: MITRE D3FEND D3-CNL\n\nNeuer Score: 22 (Medium)",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 114,
                  "score": "35"
                }
              ],
              "hasOpenThreats": false,
              "isBidirectional": false,
              "protocol": "",
              "isEncrypted": false,
              "isPublicNetwork": false,
              "handlesCardPayment": null,
              "isWebApplication": null,
              "handlesGoodsOrServices": null,
              "threatFrequency": {
                "spoofing": 0,
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 3,
                "denialOfService": 2,
                "elevationOfPrivilege": 0
              }
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "1. Auth Challenge",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              {
                "attrs": {
                  "label": {
                    "text": "Login"
                  }
                },
                "position": 0.5
              }
            ],
            "id": "35f9f840-c060-4c31-bf9a-0e17a95ddf66",
            "source": {
              "cell": "dec51efb-bf55-4b9c-a294-0e45f4e823f6"
            },
            "target": {
              "cell": "a1d5bbe6-465f-43bb-bd96-7ce687db37aa"
            },
            "vertices": [
              {
                "x": 237,
                "y": 39
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Erwarteter OTT",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              {
                "attrs": {
                  "label": {
                    "text": "1. Auth Challenge"
                  }
                },
                "position": 0.5
              }
            ],
            "id": "2503a360-01b6-4464-b35f-42c6fb583348",
            "source": {
              "cell": "a1d5bbe6-465f-43bb-bd96-7ce687db37aa"
            },
            "target": {
              "cell": "94f68ce7-aa88-45a4-ba41-c0b62d6a959c"
            },
            "vertices": [
              {
                "x": 510,
                "y": -70
              },
              {
                "x": 680,
                "y": -90
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "2. Weiterleitung\nTelefonnummer",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              {
                "attrs": {
                  "label": {
                    "text": "Erwarteter OTT"
                  }
                },
                "position": 0.5
              }
            ],
            "id": "63356151-e316-4a82-8224-9a7c729cfbee",
            "source": {
              "cell": "94f68ce7-aa88-45a4-ba41-c0b62d6a959c"
            },
            "target": {
              "cell": "a1d5bbe6-465f-43bb-bd96-7ce687db37aa"
            },
            "vertices": [
              {
                "x": 660,
                "y": 230
              },
              {
                "x": 600,
                "y": 200
              },
              {
                "x": 520,
                "y": 180
              }
            ]
          },
          {
            "shape": "trust-broundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "Externer Service für T\nelefonnummernauflö\nsung",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "labels": [
              {
                "attrs": {
                  "label": {
                    "text": "Firma Allsecure"
                  }
                },
                "position": {
                  "distance": 0,
                  "offset": 25.336937022630487
                }
              }
            ],
            "id": "8c690a8a-f100-4c4d-bd88-095a530ac220",
            "source": {
              "x": 241,
              "y": 135
            },
            "target": {
              "x": 246,
              "y": 138
            },
            "vertices": [
              {
                "x": 400,
                "y": 330
              },
              {
                "x": 1000,
                "y": 330
              },
              {
                "x": 1150,
                "y": -100
              },
              {
                "x": 890,
                "y": -390
              },
              {
                "x": 290,
                "y": -310
              },
              {
                "x": 220,
                "y": 0
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Log(Login, OTT, Phone Number)",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Log(Login, OTT, Phone Number)"
            ],
            "id": "81c8482c-19ed-41ab-bae2-a5561223b4b5",
            "source": {
              "cell": "94f68ce7-aa88-45a4-ba41-c0b62d6a959c"
            },
            "target": {
              "cell": "c2716661-ef88-48a8-8d0f-724e1923d562"
            },
            "vertices": [
              {
                "x": 980,
                "y": 20
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Code",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Code"
            ],
            "id": "fb24b375-d8b4-45ce-9a86-3788d80ecc41",
            "source": {
              "cell": "e12a53bd-e0c1-4503-8871-7fcf762361b8",
              "port": "b5c8454d-0162-408d-8195-ca6008e17709"
            },
            "target": {
              "cell": "dec51efb-bf55-4b9c-a294-0e45f4e823f6",
              "port": "c8c968fe-d53b-4728-b789-52a3199dc715"
            },
            "vertices": [
              {
                "x": 180,
                "y": -40
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Code",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Code"
            ],
            "id": "3175c187-63b4-4d43-95e5-4fc70b85277d",
            "source": {
              "cell": "94f68ce7-aa88-45a4-ba41-c0b62d6a959c",
              "port": "23ca128d-e847-40fe-9dfa-7497c0ea5e90"
            },
            "target": {
              "cell": "e12a53bd-e0c1-4503-8871-7fcf762361b8",
              "port": "b55cf779-aec2-4741-b8f7-aaef4a690e5a"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Logs",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Logs"
            ],
            "id": "b71b43e1-3ee2-4ed5-a1f3-7ce24e1f649d",
            "source": {
              "cell": "94f68ce7-aa88-45a4-ba41-c0b62d6a959c",
              "port": "23ca128d-e847-40fe-9dfa-7497c0ea5e90"
            },
            "target": {
              "cell": "affa5136-842b-4dee-9557-51dedc3ca605",
              "port": "b55cf779-aec2-4741-b8f7-aaef4a690e5a"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Logs",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Logs"
            ],
            "id": "c4622132-1941-428b-97ef-12b0de91072f",
            "source": {
              "cell": "e12a53bd-e0c1-4503-8871-7fcf762361b8",
              "port": "02c449cd-b715-4db1-ae5f-d3981c7653fd"
            },
            "target": {
              "cell": "affa5136-842b-4dee-9557-51dedc3ca605",
              "port": "b5c8454d-0162-408d-8195-ca6008e17709"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Report",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Report"
            ],
            "id": "767f683f-6f98-460e-88cb-e20f4d6d0b5e",
            "source": {
              "cell": "affa5136-842b-4dee-9557-51dedc3ca605",
              "port": "02c449cd-b715-4db1-ae5f-d3981c7653fd"
            },
            "target": {
              "cell": "9d12cdfc-1beb-42ee-84d4-19fd0f27026c",
              "port": "9a19be73-1d65-4fe3-8544-cde719df53c5"
            }
          },
          {
            "position": {
              "x": 940,
              "y": -295
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Log-DB"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 11,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "1cca8b10-3ad3-4eb8-bc03-400a9d105b40"
                },
                {
                  "group": "right",
                  "id": "073bada9-0911-456d-86f1-71a224a6d5c8"
                },
                {
                  "group": "bottom",
                  "id": "2448d482-fe22-472b-9e2d-c2bf1251fca4"
                },
                {
                  "group": "left",
                  "id": "1a3a18ee-0da4-4a0c-be7b-d52dc0ec4d2c"
                }
              ]
            },
            "id": "c2716661-ef88-48a8-8d0f-724e1923d562",
            "data": {
              "type": "tm.Store",
              "name": "Log-DB",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "isALog": true,
              "storesCredentials": false,
              "isEncrypted": true,
              "isSigned": true,
              "hasOpenThreats": false,
              "threats": [
                {
                  "id": "b0692b19-12f9-4a7d-a0a5-30d56e4733d8",
                  "title": "Löschen von Log-Daten",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Repudiation",
                  "description": "Angreifer fängt unverschlüsselte Logs ab und löscht sie, um Spuren zu verwischen\n\nCAPEC-ID CAPEC-93 -> Log Injection-Tampering-Forging\n\nATT&CK-ID: T1070 -> Indicator Removal",
                  "mitigation": "Maßnahme: TLS-Verschlüsselung für Datenbankverbindung erzwingen.\n\nUmsetzung: Konfiguration im API-Gateway/Webserver.\n\nStandard: MITRE D3FEND D3-ITF -> Inbound Traffic Filtering\n\nNeuer Score: 20 (Medium)",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 115,
                  "score": "34"
                }
              ],
              "storesInventory": null,
              "threatFrequency": {
                "tampering": 0,
                "repudiation": 3,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            }
          },
          {
            "position": {
              "x": 370,
              "y": -220
            },
            "size": {
              "width": 140,
              "height": 110
            },
            "attrs": {
              "text": {
                "text": "Allsecure\nMobile Phone\nOTT Service"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 14,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "4bbda9af-ce60-40a6-b42c-7385396c5838"
                },
                {
                  "group": "right",
                  "id": "02c449cd-b715-4db1-ae5f-d3981c7653fd"
                },
                {
                  "group": "bottom",
                  "id": "b55cf779-aec2-4741-b8f7-aaef4a690e5a"
                },
                {
                  "group": "left",
                  "id": "b5c8454d-0162-408d-8195-ca6008e17709"
                }
              ]
            },
            "id": "e12a53bd-e0c1-4503-8871-7fcf762361b8",
            "data": {
              "type": "tm.Process",
              "name": "Allsecure\nMobile Phone\nOTT Service",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 705,
              "y": -335
            },
            "size": {
              "width": 130,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "SIEM-System"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 15,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "4bbda9af-ce60-40a6-b42c-7385396c5838"
                },
                {
                  "group": "right",
                  "id": "02c449cd-b715-4db1-ae5f-d3981c7653fd"
                },
                {
                  "group": "bottom",
                  "id": "b55cf779-aec2-4741-b8f7-aaef4a690e5a"
                },
                {
                  "group": "left",
                  "id": "b5c8454d-0162-408d-8195-ca6008e17709"
                }
              ]
            },
            "id": "affa5136-842b-4dee-9557-51dedc3ca605",
            "data": {
              "type": "tm.Process",
              "name": "SIEM-System",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "d6b0e2e4-6ecb-4b41-8616-fd159143f376",
                  "title": "EoP durch Excel-Injection",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Elevation of privilege",
                  "description": "Angreifer schleust Formel (=cmd...) über Login-Feld ein. Manager öffnet Report, Befehl wird ausgeführt.\n\nCAPEC-ID: CAPEC-88 -> OS Command Injection\n\nATT&CK-ID: T1204 -> User Execution",
                  "mitigation": "Maßnahme: Input Sanitization (Output Encoding mit ' voranstellen).\n\nUmsetzung: Der Export-Algorithmus stellt jedem Feld, das mit einem Sonderzeichen (=, +, -, @) beginnt, ein ' voran (Escaping).\n\nStandard: OWASP ASVS 5.3.3\n\nNeuer Score: 11 (Low)",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 119,
                  "score": "16"
                }
              ],
              "threatFrequency": {
                "spoofing": 0,
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 0,
                "elevationOfPrivilege": 3
              }
            }
          },
          {
            "position": {
              "x": 1040,
              "y": -450
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Management"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 16,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "ee4d318e-8b85-42fd-8f78-c60d42f61332"
                },
                {
                  "group": "right",
                  "id": "56455912-7b3e-4b25-8175-44ea401ccad3"
                },
                {
                  "group": "bottom",
                  "id": "f41fb4c6-8d53-42aa-bf99-b59a53479507"
                },
                {
                  "group": "left",
                  "id": "9a19be73-1d65-4fe3-8544-cde719df53c5"
                }
              ]
            },
            "id": "9d12cdfc-1beb-42ee-84d4-19fd0f27026c",
            "data": {
              "type": "tm.Actor",
              "name": "Management",
              "description": "",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          }
        ],
        "version": "2.5.0",
        "title": "Architekturdiagramm",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "id": 0,
        "diagramType": "STRIDE"
      }
    ],
    "reviewer": "Georg Neugebauer",
    "diagramTop": 10,
    "threatTop": 123
  },
  "version": "2.5.0"
}